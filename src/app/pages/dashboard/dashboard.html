<div class="dashboard-container">
  <h1>ElectricDashboard</h1>
  <p class="welcome">Welcome back, {{ username() }}!</p>

  <!-- Address Selector and Bills Table Section -->
  <div class="bills-section">
    <app-service-address-selector
      (addressesLoaded)="onAddressesLoaded($event)"
      (addressSelected)="onAddressSelected($event)">
    </app-service-address-selector>

    <div class="bills-and-chart-container">
      <div class="bills-table-container">
        @if (loadingBills()) {
          <div class="loading">Loading bills...</div>
        } @else if (bills().length === 0) {
          <div class="no-bills">No bills found for this address</div>
        } @else {
          <div class="table-responsive">
            <table class="bills-table">
              <thead>
                <tr>
                  <th>Year</th>
                  <th>Period</th>
                  <th>Consumption (kWh)</th>
                  <th>Sent Back (kWh)</th>
                  <th>Amount</th>
                  <th>Unit Price</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                @for (bill of bills(); track bill.addressId || bill.periodStartDate) {
                  <tr>
                    <td data-label="Year">{{ bill.serviceYear }}</td>
                    <td data-label="Period">
                      {{ formatDate(bill.periodStartDate) }} -<br>
                      {{ formatDate(bill.periodEndDate) }}
                    </td>
                    <td data-label="Consumption (kWh)">{{ formatNumber(bill.consumptionKwh) }}</td>
                    <td data-label="Sent Back (kWh)">{{ formatNumber(bill.sentBackKwh) }}</td>
                    <td data-label="Amount">
                      {{ formatCurrency(bill.billedAmount) }}
                    </td>
                    <td data-label="Unit Price">
                      {{ formatCurrency(bill.unitPrice) }}
                    </td>
                    <td data-label="Actions">
                      <button class="action-btn view">View</button>
                      <button class="action-btn edit">Edit</button>
                      <button class="action-btn delete">Delete</button>
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        }
      </div>

      <div class="chart-container">
        @if (bills().length > 0) {
          <app-consumption-chart [chartData]="getChartData()"></app-consumption-chart>
        } @else {
          <div class="no-chart">No bill data available for chart</div>
        }
      </div>
    </div>
  </div>

  <!-- Menu Grid -->
  <div class="menu-grid">
    <nav class="menu-container">
      <div class="menu-item">
        <a routerLink="/dashboard/profile">
          <div class="menu-icon" aria-hidden="true">ðŸ‘¤</div>
          <h3>Profile</h3>
        </a>
      </div>

      <div class="menu-item">
        <a routerLink="/dashboard/billing">
          <div class="menu-icon" aria-hidden="true">ðŸ“Š</div>
          <h3>Data Entry</h3>
        </a>
      </div>

      <div class="menu-item">
        <a routerLink="/reports/overview">
          <div class="menu-icon" aria-hidden="true">ðŸ“ˆ</div>
          <h3>Reports</h3>
        </a>
      </div>

      <div class="menu-item logout-item">
        <a (click)="logout()">
          <div class="menu-icon" aria-hidden="true">ðŸšª</div>
          <h3>Logout</h3>
        </a>
      </div>
    </nav>
  </div>
</div>
